<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 	"http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
 	
 	
<mapper namespace="com.ezen.carCamping.model.productMapper"> 

<<<<<<< HEAD

=======
<resultMap id="brandCategoryMap" type="BrandCategoryDTO">
		<id column="brand_num" property="brand_num"/>
		<result column="brand_name" property="brand_name"/>
	</resultMap>
	
	<resultMap id="productCategoryMap" type="ProductCategoryDTO">
		<id column="pc_num" property="pc_num"/>
		<result column="pc_name" property="pc_name"/>
	</resultMap>
	
	<resultMap id="productMap" type="ProductDTO">
		<id column="prod_num" property="prod_num"/>
		<result column="prod_name" property="prod_name"/>
		<result column="prod_popular" property="prod_popular"/>
		<result column="prod_price" property="prod_price"/>
		<result column="prod_viewImage1" property="prod_viewImage1"/>
		<result column="prod_viewImage2" property="prod_viewImage2"/>
		<result column="prod_viewImage3" property="prod_viewImage3"/>
		<result column="prod_viewImage4" property="prod_viewImage4"/>
		<result column="prod_viewImage5" property="prod_viewImage5"/>
		<result column="prod_summary" property="prod_summary"/>
		<result column="prod_viewContent" property="prod_viewContent"/>
		<result column="prod_sysdate" property="prod_sysdate"/>
		<result column="prod_update" property="prod_update"/>
		<result column="prod_reviewScore" property="prod_reviewScore"/>
		<association property="brandCategoryDTO" javaType="BrandCategoryDTO" resultMap="brandCategoryMap">
		</association>
		<association property="productCategoryDTO" javaType="ProductCategoryDTO" resultMap="productCategoryMap">
		</association>
	</resultMap>

	<select id="listProduct" resultType="ProductDTO">
	select a.*, b.brand_name from Product as a left join BrandCategory as b on a.brand_num = b.brand_num
	</select>
	 
	<select id="findProduct" parameterType="java.util.Map" resultType="ProductDTO">
	select a.*, b.brand_name from Product as a left join BrandCategory as b on a.brand_num = b.brand_num where ${search} = #{searchString} or prod_name like concat('%',#{searchString},'%')
	</select>
	
	<select id="popularProd" resultType="ProductDTO">
	select * from Product where prod_popular = 0
	</select>
	
	<select id="getProduct" parameterType="int" resultType="ProductDTO">
		select * from Product where prod_num = #{prod_num}
	</select>
>>>>>>> 오신웅
	
	<select id="listProdReview" resultType="ReviewProductDTO">
		select * from ReviewProduct,Product where ReviewProduct.prod_num=#{prod_num} and ReviewProduct.prod_num = Product.prod_num
	</select>
	
	<select id="findProdReview" parameterType="java.util.Map" resultType="ReviewProductDTO">
		select * from ReviewProduct where ${search} = #{searchString} or rp_title like concat('%',#{searchString},'%')
	</select>
	
	<select id="getReviewView" resultType="ReviewProductDTO">
		select a.*,b.mem_nickName,mem_image from ReviewProduct as a left join Member as b on a.mem_num = b.mem_num where a.rp_num = #{rp_num}
	</select>
	
	<select id ="R_orderByScore" parameterType="String" resultType="ReviewProductDTO"> 
		select * from ReviewProduct order by rp_score
	</select>
	
	<select id ="R_orderByRead" parameterType="String" resultType="ReviewProductDTO"> 
		select * from ReviewProduct order by rp_readCount
	</select>
<<<<<<< HEAD

=======
	
<<<<<<< HEAD
	<!-- 시작 -->
	
	<select id="listProduct" resultType="ProductDTO">
	select a.*, b.brand_name from Product as a left join BrandCategory as b on a.brand_num = b.brand_num
	</select>
	 
	<select id="findProduct" parameterType="java.util.Map" resultType="ProductDTO">
	select a.*, b.brand_name from Product as a left join BrandCategory as b on a.brand_num = b.brand_num where ${search} = #{searchString} or prod_name like concat('%',#{searchString},'%')
	</select>
	
	<select id="popularProd" resultType="ProductDTO">
	select * from Product where prod_popular = 0
	</select>
	
	<select id="getProduct" parameterType="int" resultType="ProductDTO">
		select * from Product where prod_num = #{prod_num}
	</select>
	<select id="listProductPrice" resultType="ProductDTO">
		select * from Product order by prod_price asc;
	</select>
	
	<select id="listProductNew" resultType="ProductDTO">
		select * from Product order by prod_num desc;
	</select>
	
	<select id="listProductPop" resultType="ProductDTO">
		select * from Product order by prod_popular desc; 
	</select>
	
	<select id="listProductsearchPrice" resultType="ProductDTO">
		<!-- select a.*, b.brand_name from Product as a left join BrandCategory as b on a.brand_num = b.brand_num where ${search} = #{searchString} order by prod_price asc; -->
		select a.*, b.brand_name from songsama.Product as a left join songsama.BrandCategory as b on a.brand_num = b.brand_num where ${search} like concat('%',#{searchString},'%') order by prod_price asc;
	</select>
	
	<select id="listProductsearchNew" resultType="ProductDTO">
		<!--  select a.*, b.brand_name from Product as a left join BrandCategory as b on a.brand_num = b.brand_num where ${search} = #{searchString} order by prod_num desc;-->
		select a.*, b.brand_name from songsama.Product as a left join songsama.BrandCategory as b on a.brand_num = b.brand_num where ${search} like concat('%',#{searchString},'%') order by prod_num desc;
	</select>
	
	<select id="listProductsearchPop" resultType="ProductDTO">
		<!--  select a.*, b.brand_name from Product as a left join BrandCategory as b on a.brand_num = b.brand_num where ${search} = #{searchString} order by prod_popular desc;-->
	select a.*, b.brand_name from songsama.Product as a left join songsama.BrandCategory as b on a.brand_num = b.brand_num where ${search} like concat('%',#{searchString},'%') order by prod_popular desc;
	</select>
>>>>>>> 전용재
=======
	<select id="getAgency" resultType="AgencyDTO">
		select * from Agency
	</select>
	
	<update id="plusReviewReadCount" parameterType="Integer">
		update ReviewProduct set rp_readCount=rp_readCount+1 where rp_num = #{rp_num}
	</update>
	
	<update id="minReviewReadCount" parameterType="Integer">
		update ReviewProduct set rp_readCount=rp_readCount-1 where rp_num = #{rp_num}
	</update>
	
	<update id="plusLikeCount" parameterType="Integer">
		update ReviewProduct set rp_likeCount=rp_likeCount+1 where rp_num = #{rp_num}
	</update>
	
>>>>>>> 오신웅
</mapper>

